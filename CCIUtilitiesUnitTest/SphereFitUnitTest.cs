using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using CCIUtilities;

namespace CCIUtilitiesUnitTest
{
    [TestClass]
    public class SphereFitTest
    {
        [TestMethod]
        public void TestMethod1()
        {
            Console.WriteLine();
            Console.WriteLine("R = 12., eps = 0.5, a = 5, b = -3, c = -7");
            double[,] XYZ = new double[,] { { -6.56615, -3.11375, -6.79477 }, { -3.39945, -11.3051, -7.17076 }, { 4.78662, -15.7823, -6.39804 }, { 13.0647, -11.1643, -6.35755 }, { 17.1977, -2.87797, -7.11567 }, { 12.9583, 5.39288, -6.91152 }, { 4.87666, 9.1702, -5.98056 }, { -2.62805, 5.48716, -6.4222 }, { -5.21068, -1.41705, -1.36302 }, { -1.82276, -9.96573, -1.60494 }, { 5.22938, -13.4725, -2.07467 }, { 11.6551, -11.3702, -1.84807 }, { 16.448, -2.73204, -1.13706 }, { 11.9116, 4.84849, -1.53916 }, { 4.84408, 7.92493, -1.75535 }, { -2.60148, 4.10838, -2.23606 }, { -2.57925, -2.85463, 3.23259 }, { -0.242301, -7.51286, 3.02423 }, { 5.30939, -10.3273, 3.3533 }, { 10.5798, -6.97894, 2.23669 }, { 11.5237, -2.67731, 2.53412 }, { 10.2932, 1.85556, 3.87473 }, { 4.81536, 3.40031, 1.87914 }, { 0.293148, 2.47931, 2.71143 }, { 2.53377, -1.93171, 5.68112 }, { 4.01083, -4.49209, 5.02907 }, { 4.45963, -4.65376, 4.90606 }, { 5.24226, -5.23109, 4.67999 }, { 6.92543, -3.21217, 4.81441 }, { 5.94681, -1.18699, 4.47034 }, { 4.50345, -0.956872, 4.15247 }, { 3.84033, -1.53069, 5.69533 } };

            SphereFit sf = new SphereFit(XYZ);

            Console.WriteLine("Eta = {0}", sf.Eta);
            Console.WriteLine("R = {0}", sf.R);
            Console.WriteLine("X0 = {0}", sf.X0);
            Console.WriteLine("Y0 = {0}", sf.Y0);
            Console.WriteLine("Z0 = {0}", sf.Z0);

            Console.WriteLine();
            Console.WriteLine("R=11, a=-1, b=2, c=-3, eps = 0.1");
            XYZ = new double[,] { { -12.1016, 1.91705, -2.9424 }, { -8.86488, -5.78737, -2.96604 },
            { -1.08477, -8.92172, -2.98402 }, { 6.7158, -5.70428, -2.96097 }, { 10.0279, 1.96529, -2.94177 },
            { 6.7861, 9.85617, -3.05894 }, { -1.08469, 12.8659, -2.88502 }, { -8.71681, 9.89627, -2.92641 },
            { -10.5895, 1.94547, 2.0132 }, { -7.89774, -5.04593, 1.8828 }, { -1.00749, -7.74667, 2.00703 },
            { 6.03301, -5.001, 1.93936 }, { 8.88039, 1.9986, 1.97165 }, { 5.93076, 8.84064, 2.11023 },
            { -1.02688, 11.763, 2.03656 }, { -7.75837, 8.96905, 2.15301 }, { -7.48324, 2.10357, 5.96054 },
            { -5.60289, -2.56065, 5.92799 }, { -0.938237, -4.61239, 5.85747 }, { 3.50658, -2.67384, 5.72483 },
            { 5.46248, 1.95321, 5.84887 }, { 3.499, 6.71904, 6.00478 }, { -0.965878, 8.62581, 5.95308 },
            { -5.66266, 6.56596, 5.69533 }, { -2.76841, 1.77566, 7.91651 }, { -2.21338, 0.70516, 7.83037 },
            { -1.19271, 0.149784, 7.89726 }, { 0.0979437, 0.954727, 7.74043 }, { 0.787422, 1.88295, 7.83482 },
            { 0.237305, 3.15421, 7.83916 }, { -1.08976, 3.70758, 7.95334 }, { -2.44813, 3.39823, 7.70806 } };

            sf = new SphereFit(XYZ);

            Console.WriteLine("Eta = {0}", sf.Eta);
            Console.WriteLine("R = {0}", sf.R);
            Console.WriteLine("X0 = {0}", sf.X0);
            Console.WriteLine("Y0 = {0}", sf.Y0);
            Console.WriteLine("Z0 = {0}", sf.Z0);

            Console.WriteLine();
            Console.WriteLine("R = 11., eps = 0.5, a = -10, b = 2, c = -3");
            XYZ = new double[,] { { -20.4822, 1.70668, -3.48335 }, { -17.2819, -6.07408, -2.72225 },
            { -10.076, -9.03948, -3.45688 }, { -1.86592, -5.83439, -3.65106 }, { 0.534786, 1.34149, -2.73412 },
            { -2.70372, 9.82848, -3.40883 }, { -10.1276, 13.2388, -2.6858 }, { -17.7671, 9.18743, -2.82023 },
            { -19.4016, 2.18785, 2.22125 }, { -16.9362, -4.72862, 1.75222 }, { -10.0339, -8.01797, 2.59202 },
            { -3.42718, -5.44431, 2.1607 }, { -0.774722, 2.50423, 1.92468 }, { -2.97679, 9.89852, 2.09612 },
            { -9.78053, 12.2702, 1.47426 }, { -17.2397, 9.43193, 1.94662 }, { -16.7315, 2.39188, 6.38183 },
            { -14.5223, -2.30408, 6.18017 }, { -9.50956, -4.50656, 4.89034 }, { -4.60966, -2.75145, 5.47964 },
            { -3.23396, 2.23795, 5.25057 }, { -5.34468, 7.11671, 6.02657 }, { -10.2767, 8.45401, 5.7415 },
            { -14.2022, 5.96109, 5.95006 }, { -11.1173, 1.97431, 7.21809 }, { -11.3502, -0.0101863, 7.45137 },
            { -10.7642, -0.250874, 7.17267 }, { -9.07307, 0.662839, 8.02505 }, { -8.2412, 2.37552, 7.61088 },
            { -8.79987, 2.69626, 8.63083 }, { -9.71479, 4.096, 8.38751 }, { -11.579, 3.35141, 7.79078 } };

            sf = new SphereFit(XYZ);

            Console.WriteLine("Eta = {0}", sf.Eta);
            Console.WriteLine("R = {0}", sf.R);
            Console.WriteLine("X0 = {0}", sf.X0);
            Console.WriteLine("Y0 = {0}", sf.Y0);
            Console.WriteLine("Z0 = {0}", sf.Z0);

            Console.WriteLine();
            Console.WriteLine("R = 12., eps = 1, a = 10, b = -3, c = -7, n = 32");
            XYZ = new double[,] { { -1.28667, -2.38454, -7.10869 }, { 2.68201, -12.5633, -5.93188 },
            { 9.76421, -13.6321, -7.50642 }, { 18.3221, -10.3647, -7.17533 }, { 22.7741, -1.70526, -6.53488 },
            { 18.9259, 6.08413, -7.14173 }, { 9.41413, 8.73683, -6.0662 }, { 2.06683, 7.50606, -7.28002 },
            { 0.995535, -3.50441, 0.508232 }, { 2.88878, -10.738, -0.406471 }, { 10.1554, -13.3744, 0.458373 },
            { 15.9699, -9.39608, -1.63471 }, { 22.0412, -4.78107, -0.0796556 }, { 17.728, 4.48841, -2.30113 },
            { 10.1405, 7.41134, -1.66483 }, { 1.58182, 6.36647, -2.69059 }, { 2.8532, -4.09926, 1.81284 },
            { 4.95342, -8.3902, 0.448227 }, { 11.1138, -10.2939, 2.64518 }, { 13.688, -8.72745, 0.840794 },
            { 18.1428, -1.93176, 2.75412 }, { 15.9389, 0.109582, 2.38474 }, { 10.6217, 2.97052, 1.95598 },
            { 3.58975, 1.8127, 2.99616 }, { 7.86386, -4.16905, 5.40502 }, { 10.0583, -5.36043, 3.55343 },
            { 8.47865, -5.83492, 4.98588 }, { 10.9896, -5.76523, 4.23566 }, { 11.085, -2.4362, 4.59694 },
            { 10.6429, -3.88176, 3.96223 }, { 10.1068, -1.72405, 6.02519 }, { 7.33379, -0.304348, 4.4756 } };

            sf = new SphereFit(XYZ);

            Console.WriteLine("Eta = {0}", sf.Eta);
            Console.WriteLine("R = {0}", sf.R);
            Console.WriteLine("X0 = {0}", sf.X0);
            Console.WriteLine("Y0 = {0}", sf.Y0);
            Console.WriteLine("Z0 = {0}", sf.Z0);

            Console.WriteLine();
            Console.WriteLine("R = 12., eps = 1, a = 10, b = -3, c = -7, n = 109");
            XYZ = new double[,] { { -3.11666, -2.30593, -5.18229 }, { 0.916022, -7.50238, -6.51229 },
            { 1.53174, -12.5472, -6.83834 }, { 3.86634, -13.217, -7.33859 }, { 11.1584, -13.161, -7.63025 },
            { 15.4094, -15.3095, -6.59301 }, { 18.5125, -11.2879, -5.80637 }, { 20.7324, -8.15245, -7.82271 },
            { 21.3558, -2.92207, -7.59227 }, { 21.3654, -0.514446, -7.81191 }, { 18.1905, 5.54306, -7.38704 },
            { 13.9489, 8.74508, -7.22057 }, { 10.4578, 9.98686, -6.25971 }, { 3.49532, 8.36044, -7.11757 },
            { 1.65082, 5.15358, -7.21787 }, { -3.07738, 1.08383, -7.07502 }, { -2.44781, -2.92402, -2.53021 },
            { -2.2258, -7.87936, -3.82629 }, { 0.92295, -12.0771, -5.6732 }, { 6.18253, -13.7787, -3.18028 },
            { 9.24235, -15.0707, -3.33926 }, { 15.5392, -11.8373, -3.4986 }, { 16.5107, -11.0385, -2.47717 },
            { 21.829, -7.38209, -2.83023 }, { 21.6291, -1.16105, -5.45141 }, { 20.7722, 0.341038, -4.67288 },
            { 19.8709, 4.57758, -3.27146 }, { 16.2316, 7.92047, -4.99144 }, { 7.58745, 6.70753, -3.85977 },
            { 5.66563, 8.533, -4.22237 }, { 2.72522, 3.55643, -3.32392 }, { 0.0769216, 2.05646, -4.29221 },
            { 0.568798, -2.13091, -1.13374 }, { 0.647293, -8.14055, -3.7235 }, { 1.94273, -11.0547, -2.05822 },
            { 5.86365, -13.9907, 0.435002 }, { 10.0177, -13.8582, -1.95205 }, { 14.47, -12.8465, -1.40832 },
            { 16.6747, -10.2712, -1.82901 }, { 18.1187, -6.38859, -2.56949 }, { 22.2937, -2.2855, -2.74442 },
            { 19.8367, 0.708506, -2.28858 }, { 17.0735, 5.01777, -4.05062 }, { 14.9254, 4.73819, -2.11053 },
            { 10.5656, 7.84423, -0.809539 }, { 3.6352, 7.10562, -2.36 }, { 1.58372, 4.36165, -1.71293 },
            { 0.779831, 1.58332, -1.85556 }, { -1.4534, -3.19105, 0.401986 }, { 2.333, -5.69802, 1.0916 },
            { 3.57307, -10.1078, 1.10867 }, { 5.39164, -12.5627, 2.26772 }, { 10.6532, -12.7017, 1.06028 },
            { 11.763, -11.2251, -0.179883 }, { 14.7495, -9.25364, 2.19023 }, { 18.4378, -5.04474, 1.05607 },
            { 19.3659, -1.48543, 2.07977 }, { 17.813, 0.386736, 0.810445 }, { 16.423, 3.92616, 0.090263 },
            { 13.3095, 5.55169, -0.181592 }, { 10.4579, 4.83009, 1.62342 }, { 6.80259, 5.51431, -0.221506 },
            { 4.46954, 2.99389, 0.891838 }, { 0.215151, 0.833837, -0.700703 }, { 2.80302, -1.55211, 2.90917 },
            { 4.58082, -6.34217, 2.4825 }, { 4.86312, -8.1035, 3.12742 }, { 7.10315, -9.28707, 3.07001 },
            { 9.497, -8.64267, 3.26399 }, { 12.0393, -9.28904, 3.41741 }, { 15.0816, -9.7876, 1.07791 },
            { 16.4446, -4.57644, 1.86811 }, { 16.7021, -1.37326, 1.94469 }, { 16.5361, -0.776926, 3.70435 },
            { 14.9553, 2.2141, 3.45979 }, { 13.3419, 2.11018, 2.65488 }, { 9.35779, 4.11844, 3.88235 },
            { 5.61742, 3.37792, 3.99951 }, { 4.61747, 0.747083, 4.11742 }, { 3.54042, -0.435522, 3.96571 },
            { 4.69726, -2.51143, 4.44239 }, { 4.30086, -3.48435, 3.01783 }, { 7.99017, -6.11821, 3.49725 },
            { 6.22907, -6.98198, 4.35991 }, { 10.1792, -8.32212, 4.94782 }, { 10.4341, -9.05837, 1.75223 },
            { 13.9529, -4.24538, 3.59597 }, { 15.1582, -6.0591, 6.07448 }, { 13.2755, -3.25848, 4.53918 },
            { 13.9712, 1.05898, 4.43917 }, { 12.7737, 0.775474, 3.91112 }, { 11.036, 0.79655, 3.58748 },
            { 9.65068, 0.357976, 5.15589 }, { 8.957, 0.803327, 5.76392 }, { 7.73907, 2.84216, 3.42851 },
            { 6.81843, 0.00674779, 4.53474 }, { 8.31182, -2.50282, 5.19159 }, { 8.10848, -4.10212, 4.14017 },
            { 9.54533, -4.084, 4.95627 }, { 10.6541, -5.14148, 4.6595 }, { 11.0998, -4.93438, 4.58234 },
            { 11.4314, -4.7831, 5.48695 }, { 11.9596, -4.66125, 5.12054 }, { 11.9907, -4.0602, 3.90639 },
            { 11.7928, -3.56817, 6.04249 }, { 11.413, -3.18837, 5.15114 }, { 11.0376, 0.0149492, 5.21004 },
            { 10.097, 0.0513185, 4.65275 }, { 10.487, -1.63548, 7.7343 }, { 10.1512, -1.4573, 4.67254 },
            { 9.83146, -2.78382, 4.67015 }, { 10.9186, -0.989746, 5.02382 } };

            sf = new SphereFit(XYZ);

            Console.WriteLine("Eta = {0}", sf.Eta);
            Console.WriteLine("R = {0}", sf.R);
            Console.WriteLine("X0 = {0}", sf.X0);
            Console.WriteLine("Y0 = {0}", sf.Y0);
            Console.WriteLine("Z0 = {0}", sf.Z0);
        }
    }
}
